function calculatePrice(){var t=parseFloat($("#cal-price").attr("value"));$(".modifier").each(function(){t+=parseFloat($("option:selected",this).attr("price"))}),$("#cal-price").html(t.formatMoney(2,".",",")),$("#price").val(t.formatMoney(2,".",","))}function calculateAllPrices(){$(".product-form-class").each(function(){var t=$(this).attr("data-product-id"),o=parseFloat($("#cal-price-"+t).attr("value")),e=parseFloat($("#cal-oldprice-"+t).attr("value"));$(this).find(".modifier").each(function(){o+=parseFloat($("option:selected",this).attr("price")),e+=parseFloat($("option:selected",this).attr("oldprice"))}),$("#cal-price-"+t).html(o.formatMoney(0,".",",")),o==e?$("#cal-oldprice-"+t).closest("div").hide():($("#cal-oldprice-"+t).closest("div").show(),$("#cal-oldprice-"+t).html(e.formatMoney(0,".",","))),$("#price-"+t).val(o.formatMoney(0,".",","))})}function addCart(t,o){if(running)return!1;running=!0,$("body").css("cursor","wait"),$(".btn-primary").addClass("disabled").attr("disabled","disabled");var e=$("#"+t).serialize();$.ajax({type:"POST",url:"/process/cart",cache:!1,data:e,dataType:"json",success:function(t){try{t.error?($("#cart-notification").find("strong").html(t.error),$("#cart-notification").fadeIn("slow"),$("html, body").animate({scrollTop:$("#cart-notification").scrollTop()},"1000","swing")):($("#cart-notification").find("strong").html(""),$("#cart-notification").hide(),t.url&&$(window).width()<760||o?window.location.href=t.url:($(".nav-itemNumber").html(t.itemsCount),$(".nav-subtotal").html("$"+t.subtotal),$("#shop-cart-btn").html(t.popoverShopCart),$("html, body").animate({scrollTop:$("#shop-cart-btn").scrollTop()},"1000","swing"),$("#shop-cart-btn").fadeIn(200),setTimeout(function(){$("#shop-cart-btn").fadeOut(200)},4e3)))}catch(t){console.log("TRY-CATCH error")}$("body").css("cursor","default"),$(".btn-primary").removeClass("disabled").removeAttr("disabled"),running=!1},error:function(t,o,e){$("body").css("cursor","default"),console.log("AJAX error:"+e),$(".btn-primary").removeClass("disabled"),running=!1}})}function updateCart(){$("body").css("cursor","wait");var t=$("#shopping-cart-form").serialize();$.ajax({type:"POST",url:"/process/cart",cache:!1,data:"action=updateCart&"+t,dataType:"json",success:function(t){try{var o=t.priceunits,e=t.pricemodifier,a=t.subtotals,r=t.totals;$(".nav-itemNumber").html(t.itemsCount),$("#shop-cart-btn").html(t.popoverShopCart),a?($.each(e,function(t,o){"0%"===o?$("#qty-discount-"+t).html(""):o&&$("#qty-discount-"+t).html("(-"+o+")")}),$.each(o,function(t,o){amount=parseFloat(o),$("#priceunit-"+t).html("$"+amount.formatMoney(2,".",","))}),$.each(a,function(t,o){amount=parseFloat(o),$("#subtotal-"+t).html("$"+amount.formatMoney(2,".",","))}),$.each(r,function(t,o){amount=parseFloat(o),"subtotal"!=t&&"discount"!=t||($("#"+t).attr("data-value",amount),$("#"+t).html(("discount"==t?"-":"")+"$"+amount.formatMoney(2,".",",")),amount&&$("#"+t).closest(".row").show()),"discount_code"==t&&($("#promo").val(o),$("#promo").attr("value",o),null==o&&$(".promo_applied").html("")),"discount_code_msg"==t&&""!=o&&$(".promo_applied").html(o)}),updateShipping(),calculateTotal()):alert("Error: Cannot be updated"),$("body").css("cursor","default")}catch(t){console.log("TRY-CATCH error - "+t),$("body").css("cursor","default")}},error:function(t,o,e){$("body").css("cursor","default"),console.log("AJAX error:"+e)}})}function deleteItem(t){$("body").css("cursor","wait"),$("#"+t).fadeTo("fast",.5);var o=$("#formToken").val();$.ajax({type:"POST",url:"/process/cart",cache:!1,data:"action=DeleteItem&cartitem_id="+t+"&formToken="+o,dataType:"json",success:function(o){try{var e=o.response,a=o.totals;$(".nav-itemNumber").html(o.itemsCount),$(".nav-subtotal").html("$"+o.totals.subtotal),$("#shop-cart-btn").html(o.popoverShopCart),e?parseInt(o.itemsCount)>0?($("#"+t).hide("slow"),$.each(a,function(t,o){amount=parseFloat(o),"total"==t&&(amount+=parseFloat($("#shippingMethod").attr("data-value"))),$("#"+t).html("$"+amount.formatMoney(2,".",",")),"discount_code"==t&&($("#promo").val(o),$("#promo").attr("value",o),null==o&&$(".promo_applied").html("")),"discount_code_msg"==t&&""!=o&&$(".promo_applied").html(o)})):location.reload():($("#"+t).fadeTo("fast",1),alert("Item cannot be deleted"))}catch(o){$("#"+t).fadeTo("slow",1),console.log("TRY-CATCH error")}$("body").css("cursor","default")},error:function(o,e,a){$("#"+t).fadeTo("slow",1),console.log("AJAX error:"+a),$("body").css("cursor","default")}})}function checkout2(t){$("body").css("cursor","wait");var o=$("#"+t).serialize();$.ajax({type:"POST",url:"/process/cart",cache:!1,data:o,dataType:"json",success:function(t){try{if(t.response){$(".checkout2").hide(),$(".checkout3").show(),$("#billing-summary").html(t.billing),$("#shipping-summary").html(t.shipping),setCCRequired(!0),scrolltodiv("#checkout3-form")}}catch(t){console.log("TRY-CATCH error")}$("body").css("cursor","default")},error:function(t,o,e){$("body").css("cursor","default"),console.log("AJAX error:"+e)}})}function addProductCart(t,o,e){$("body").css("cursor","wait"),$.ajax({type:"POST",url:"/process/cart",cache:!1,data:"action=ADDTOCART&product_id="+t+"&quantity="+o+"&price="+e,dataType:"json",success:function(t){try{t.url&&(window.location.href=t.url)}catch(t){console.log("TRY-CATCH error")}$("body").css("cursor","default")},error:function(t,o,e){$("body").css("cursor","default"),console.log("AJAX error:"+e)}})}function renderShippingMethods(t){"select"==$("#shippingMethod").get(0).tagName&&($("#shippingMethod").empty(),$.each(t,function(t,o){$("#shippingMethod").append($("<option>",{value:o,text:t}))}))}function updateShipping(){return!0}function calculateTotal(){var t=parseFloat($("#subtotal").attr("data-value")),o=parseFloat($("#shippingMethod").attr("data-value")),e=parseFloat($("#discount").attr("data-value")),a=t+o-e;return $("#total").html("$"+a.formatMoney(2,".",",")),!0;var o,a}function scrolltodiv(t){$("html,body").animate({scrollTop:$(t).offset().top})}function isArray(t){return"[object Array]"===Object.prototype.toString.call(t)}function addProductWishList(t){return!(RunningWishList||!t)&&(RunningWishList=!0,$("body").css("cursor","wait"),void $.ajax({type:"POST",url:"/process/cart",cache:!1,data:"action=addProductWishList&product_object_id="+t,dataType:"json",success:function(o){try{o.url?window.location.href=o.url:o.success?($(".prodwishlist-"+t).addClass("active"),$(".prodwishlist-"+t).find("img").attr("src","/images/prod-wishlist-selected.png")):o.error,RunningWishList=!1}catch(t){console.log("TRY-CATCH error"),RunningWishList=!1}$("body").css("cursor","default")},error:function(t,o,e){$("body").css("cursor","default"),console.log("AJAX error:"+e)}}))}function deleteProductWishList(t){return!(RunningWishList||!t)&&(RunningWishList=!0,$("body").css("cursor","wait"),void $.ajax({type:"POST",url:"/process/cart",cache:!1,data:"action=deleteProductWishList&product_object_id="+t,dataType:"json",success:function(o){try{if(o.url)window.location.href=o.url;else if(o.success){if($(".prodwishlist-"+t).removeClass("active"),$(".prodwishlist-"+t).find("img").attr("src","/images/prod-wishlist.png"),$("#wish-list").length){$(".prodwishlist-"+t).closest(".prodout").remove(),$("#wish-list .prodout").length<1&&$("#noproducts").show();try{$("#products-wrapper").isotope("reloadItems").isotope()}catch(t){}}}else o.error;RunningWishList=!1}catch(t){console.log("TRY-CATCH error"),RunningWishList=!1}$("body").css("cursor","default")},error:function(t,o,e){$("body").css("cursor","default"),console.log("AJAX error:"+e)}}))}function RunAutocomplete(){$("body").css("cursor","wait");var t=$("#search").val();t.length>3?(ajaxtimestamp=(new Date).getTime(),$.ajax({type:"POST",url:"/process/autocomplete",cache:!1,data:"action=product&q="+t+"&timestamp="+ajaxtimestamp,dataType:"json",success:function(t,o){try{t.success&&ajaxtimestamp==t.timestamp&&$("#autocomplete-search-results").html(t.template),!t.success&&t.error&&$("#autocomplete-search-results").html("<h4>"+t.error+"</h4>"),$("#autocomplete-search-results").show()}catch(t){}$("body").css("cursor","default")},error:function(t,o,e){$("body").css("cursor","default"),console.log("AJAX error:"+e)}})):$("#autocomplete-search-results").hide()}function triggerAutocomplete(){clearTimeout(autocomplete),autocomplete=setTimeout(function(){RunAutocomplete()},2e3)}$(".modifier").change(function(){calculateAllPrices()}),$("#promo").bind("keyup",function(t){13==t.keyCode&&$("#promo").closest("form").submit()}),$(".gt-zero").change(function(){(parseInt($(this).val())<1||""==$(this).val())&&$(this).val("1")}),$(".unsigned-int").keyup(function(){this.value!=this.value.replace(/[^0-9]/g,"")&&(this.value=this.value.replace(/[^0-9]/g,""))});var running=!1;$(".quantity").change(function(){updateCart()}),$("#shippingMethod").change(function(){parseFloat($(this).val());calculateTotal()}),Number.prototype.formatMoney=function(t,o,e){var a=this,t=isNaN(t=Math.abs(t))?2:t,o=void 0==o?".":o,e=void 0==e?",":e,r=a<0?"-":"",s=parseInt(a=Math.abs(+a||0).toFixed(t))+"",c=(c=s.length)>3?c%3:0;return r+(c?s.substr(0,c)+e:"")+s.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+e)+(t?o+Math.abs(a-s).toFixed(t).slice(2):"")},$(".prodwishlist").click(function(){var t=$(this).attr("data-pid");$(this).hasClass("active")?deleteProductWishList(t):addProductWishList(t)});var RunningWishList=!1,ajaxtimestamp=null,autocomplete;